#!/usr/bin/env node

const program = require('commander')
const requiredNodeVersion = require('../package.json').engines.node
const { checkNodeVersion, cleanArgs } = require('../dist/utils/cli')

checkNodeVersion(requiredNodeVersion)

program
  .usage('<command> [options]')
  .version(require('../package.json').version)

program
  .command('init')
  .option('-g, --get <path>', 'get value from option')
  .option('-s, --set', 'set option value')
  .description('初始化 MIP 项目')
  .action((cmd) => {
    require('../dist/init').init(cleanArgs(cmd))
  })

program
  .command('add <component-name>')
  .option('-v, --vue', '添加组件类型为 Vue 组件')
  .option('-f, --force', '是否覆盖')
  .description('新增一个组件')
  .action((cname, args) => {
    require('../dist/add').add({ compName: cname, options: cleanArgs(args) })
  })

program.parse(process.argv)

if (!process.argv.slice(2).length) {
  program.outputHelp()
}
